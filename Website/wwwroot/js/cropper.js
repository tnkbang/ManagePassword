/* Cropper.js v1.5.12 */
!function (t, i) { "object" == typeof exports && "undefined" != typeof module ? module.exports = i() : "function" == typeof define && define.amd ? define(i) : (t = "undefined" != typeof globalThis ? globalThis : t || self).Cropper = i() }(this, function () { "use strict"; function t(t, i) { var e = Object.keys(t); if (Object.getOwnPropertySymbols) { var a = Object.getOwnPropertySymbols(t); i && (a = a.filter(function (i) { return Object.getOwnPropertyDescriptor(t, i).enumerable })), e.push.apply(e, a) } return e } function i(i) { for (var e = 1; e < arguments.length; e++) { var a = null != arguments[e] ? arguments[e] : {}; e % 2 ? t(Object(a), !0).forEach(function (t) { n(i, t, a[t]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(i, Object.getOwnPropertyDescriptors(a)) : t(Object(a)).forEach(function (t) { Object.defineProperty(i, t, Object.getOwnPropertyDescriptor(a, t)) }) } return i } function e(t) { return (e = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t })(t) } function a(t, i) { for (var e = 0; e < i.length; e++) { var a = i[e]; a.enumerable = a.enumerable || !1, a.configurable = !0, "value" in a && (a.writable = !0), Object.defineProperty(t, a.key, a) } } function n(t, i, e) { return i in t ? Object.defineProperty(t, i, { value: e, enumerable: !0, configurable: !0, writable: !0 }) : t[i] = e, t } function o(t) { return function t(i) { if (Array.isArray(i)) return r(i) }(t) || function t(i) { if ("undefined" != typeof Symbol && null != i[Symbol.iterator] || null != i["@@iterator"]) return Array.from(i) }(t) || function t(i, e) { if (i) { if ("string" == typeof i) return r(i, e); var a = Object.prototype.toString.call(i).slice(8, -1); if ("Object" === a && i.constructor && (a = i.constructor.name), "Map" === a || "Set" === a) return Array.from(i); if ("Arguments" === a || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)) return r(i, e) } }(t) || function t() { throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function r(t, i) { (null == i || i > t.length) && (i = t.length); for (var e = 0, a = Array(i); e < i; e++)a[e] = t[e]; return a } var s = "undefined" != typeof window && void 0 !== window.document, h = s ? window : {}, c = !!s && !!h.document.documentElement && "ontouchstart" in h.document.documentElement, l = !!s && "PointerEvent" in h, d = "cropper", p = "crop", g = "move", u = "zoom", m = "".concat(d, "-crop"), f = "".concat(d, "-disabled"), v = "".concat(d, "-hidden"), $ = "".concat(d, "-hide"), w = "".concat(d, "-invisible"), x = "".concat(d, "-modal"), y = "".concat(d, "-move"), b = "".concat(d, "Action"), _ = "".concat(d, "Preview"), C = "crop", D = "move", B = "none", k = "crop", T = "cropend", W = "cropmove", E = "cropstart", H = "dblclick", L = l ? "pointerdown" : c ? "touchstart" : "mousedown", z = l ? "pointermove" : c ? "touchmove" : "mousemove", Y = l ? "pointerup pointercancel" : c ? "touchend touchcancel" : "mouseup", X = "ready", R = "resize", O = "wheel", M = "zoom", S = "image/jpeg", I = /^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/, P = /^data:/, A = /^data:image\/jpeg;base64,/, N = /^img|canvas$/i, U = { viewMode: 0, dragMode: C, initialAspectRatio: NaN, aspectRatio: NaN, data: null, preview: "", responsive: !0, restore: !0, checkCrossOrigin: !0, checkOrientation: !0, modal: !0, guides: !0, center: !0, highlight: !0, background: !0, autoCrop: !0, autoCropArea: .8, movable: !0, rotatable: !0, scalable: !0, zoomable: !0, zoomOnTouch: !0, zoomOnWheel: !0, wheelZoomRatio: .1, cropBoxMovable: !0, cropBoxResizable: !0, toggleDragModeOnDblclick: !0, minCanvasWidth: 0, minCanvasHeight: 0, minCropBoxWidth: 0, minCropBoxHeight: 0, minContainerWidth: 200, minContainerHeight: 100, ready: null, cropstart: null, cropmove: null, cropend: null, crop: null, zoom: null }, q = Number.isNaN || h.isNaN; function j(t) { return "number" == typeof t && !q(t) } var F = function t(i) { return i > 0 && i < 1 / 0 }; function Q(t) { return void 0 === t } function K(t) { return "object" === e(t) && null !== t } var Z = Object.prototype.hasOwnProperty; function G(t) { if (!K(t)) return !1; try { var i = t.constructor, e = i.prototype; return i && e && Z.call(e, "isPrototypeOf") } catch (a) { return !1 } } function J(t) { return "function" == typeof t } var V = Array.prototype.slice; function tt(t) { return Array.from ? Array.from(t) : V.call(t) } function ti(t, i) { return t && J(i) && (Array.isArray(t) || j(t.length) ? tt(t).forEach(function (e, a) { i.call(t, e, a, t) }) : K(t) && Object.keys(t).forEach(function (e) { i.call(t, t[e], e, t) })), t } var te = Object.assign || function t(i) { for (var e = arguments.length, a = Array(e > 1 ? e - 1 : 0), n = 1; n < e; n++)a[n - 1] = arguments[n]; return K(i) && a.length > 0 && a.forEach(function (t) { K(t) && Object.keys(t).forEach(function (e) { i[e] = t[e] }) }), i }, ta = /\.\d*(?:0|9){12}\d*$/; function tn(t) { var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1e11; return ta.test(t) ? Math.round(t * i) / i : t } var to = /^width|height|left|top|marginLeft|marginTop$/; function tr(t, i) { var e = t.style; ti(i, function (t, i) { to.test(i) && j(t) && (t = "".concat(t, "px")), e[i] = t }) } function ts(t, i) { if (i) { if (j(t.length)) { ti(t, function (t) { ts(t, i) }); return } if (t.classList) { t.classList.add(i); return } var e = t.className.trim(); e ? 0 > e.indexOf(i) && (t.className = "".concat(e, " ").concat(i)) : t.className = i } } function th(t, i) { if (i) { if (j(t.length)) { ti(t, function (t) { th(t, i) }); return } if (t.classList) { t.classList.remove(i); return } t.className.indexOf(i) >= 0 && (t.className = t.className.replace(i, "")) } } function tc(t, i, e) { if (i) { if (j(t.length)) { ti(t, function (t) { tc(t, i, e) }); return } e ? ts(t, i) : th(t, i) } } var tl = /([a-z\d])([A-Z])/g; function td(t) { return t.replace(tl, "$1-$2").toLowerCase() } function tp(t, i) { return K(t[i]) ? t[i] : t.dataset ? t.dataset[i] : t.getAttribute("data-".concat(td(i))) } function tg(t, i, e) { K(e) ? t[i] = e : t.dataset ? t.dataset[i] = e : t.setAttribute("data-".concat(td(i)), e) } var tu = /\s\s*/, tm = function () { var t = !1; if (s) { var i = !1, e = function t() { }, a = Object.defineProperty({}, "once", { get: function e() { return t = !0, i }, set: function t(e) { i = e } }); h.addEventListener("test", e, a), h.removeEventListener("test", e, a) } return t }(); function tf(t, i, e) { var a = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {}, n = e; i.trim().split(tu).forEach(function (i) { if (!tm) { var o = t.listeners; o && o[i] && o[i][e] && (n = o[i][e], delete o[i][e], 0 === Object.keys(o[i]).length && delete o[i], 0 === Object.keys(o).length && delete t.listeners) } t.removeEventListener(i, n, a) }) } function tv(t, i, e) { var a = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {}, n = e; i.trim().split(tu).forEach(function (i) { if (a.once && !tm) { var o = t.listeners, r = void 0 === o ? {} : o; n = function o() { delete r[i][e], t.removeEventListener(i, n, a); for (var s = arguments.length, h = Array(s), c = 0; c < s; c++)h[c] = arguments[c]; e.apply(t, h) }, r[i] || (r[i] = {}), r[i][e] && t.removeEventListener(i, r[i][e], a), r[i][e] = n, t.listeners = r } t.addEventListener(i, n, a) }) } function t$(t, i, e) { var a; return J(Event) && J(CustomEvent) ? a = new CustomEvent(i, { detail: e, bubbles: !0, cancelable: !0 }) : (a = document.createEvent("CustomEvent")).initCustomEvent(i, !0, !0, e), t.dispatchEvent(a) } function tw(t) { var i = t.getBoundingClientRect(); return { left: i.left + (window.pageXOffset - document.documentElement.clientLeft), top: i.top + (window.pageYOffset - document.documentElement.clientTop) } } var tx = h.location, ty = /^(\w+:)\/\/([^:/?#]*):?(\d*)/i; function tb(t) { var i = t.match(ty); return null !== i && (i[1] !== tx.protocol || i[2] !== tx.hostname || i[3] !== tx.port) } function t_(t) { var i = "timestamp=".concat(new Date().getTime()); return t + (-1 === t.indexOf("?") ? "?" : "&") + i } function tC(t) { var i = t.rotate, e = t.scaleX, a = t.scaleY, n = t.translateX, o = t.translateY, r = []; j(n) && 0 !== n && r.push("translateX(".concat(n, "px)")), j(o) && 0 !== o && r.push("translateY(".concat(o, "px)")), j(i) && 0 !== i && r.push("rotate(".concat(i, "deg)")), j(e) && 1 !== e && r.push("scaleX(".concat(e, ")")), j(a) && 1 !== a && r.push("scaleY(".concat(a, ")")); var s = r.length ? r.join(" ") : "none"; return { WebkitTransform: s, msTransform: s, transform: s } } function tD(t, e) { var a = t.pageX, n = t.pageY, o = { endX: a, endY: n }; return e ? o : i({ startX: a, startY: n }, o) } function tB(t) { var i = t.aspectRatio, e = t.height, a = t.width, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "contain", o = F(a), r = F(e); if (o && r) { var s = e * i; "contain" === n && s > a || "cover" === n && s < a ? e = a / i : a = e * i } else o ? e = a / i : r && (a = e * i); return { width: a, height: e } } var tk = String.fromCharCode, tT = /^data:.*,/, tW = h.Cropper, tE = function () { var t, i, e; function n(t) { var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; if (!function t(i, e) { if (!(i instanceof e)) throw TypeError("Cannot call a class as a function") }(this, n), !t || !N.test(t.tagName)) throw Error("The first argument is required and must be an <img> or <canvas> element."); this.element = t, this.options = te({}, U, G(i) && i), this.cropped = !1, this.disabled = !1, this.pointers = {}, this.ready = !1, this.reloading = !1, this.replaced = !1, this.sized = !1, this.sizing = !1, this.init() } return t = n, i = [{ key: "init", value: function t() { var i, e = this.element, a = e.tagName.toLowerCase(); if (!e[d]) { if (e[d] = this, "img" === a) { if (this.isImg = !0, i = e.getAttribute("src") || "", this.originalUrl = i, !i) return; i = e.src } else "canvas" === a && window.HTMLCanvasElement && (i = e.toDataURL()); this.load(i) } } }, { key: "load", value: function t(i) { var e, a, n, o, r, s = this; if (i) { this.url = i, this.imageData = {}; var h = this.element, c = this.options; if (c.rotatable || c.scalable || (c.checkOrientation = !1), !c.checkOrientation || !window.ArrayBuffer) { this.clone(); return } if (P.test(i)) { A.test(i) ? this.read((a = (e = i).replace(tT, ""), n = atob(a), o = new ArrayBuffer(n.length), r = new Uint8Array(o), ti(r, function (t, i) { r[i] = n.charCodeAt(i) }), o)) : this.clone(); return } var l = new XMLHttpRequest, d = this.clone.bind(this); this.reloading = !0, this.xhr = l, l.onabort = d, l.onerror = d, l.ontimeout = d, l.onprogress = function () { l.getResponseHeader("content-type") !== S && l.abort() }, l.onload = function () { s.read(l.response) }, l.onloadend = function () { s.reloading = !1, s.xhr = null }, c.checkCrossOrigin && tb(i) && h.crossOrigin && (i = t_(i)), l.open("GET", i, !0), l.responseType = "arraybuffer", l.withCredentials = "use-credentials" === h.crossOrigin, l.send() } } }, { key: "read", value: function t(i) { var e = this.options, a = this.imageData, n = function t(i) { var e = new DataView(i); try { if (255 === e.getUint8(0) && 216 === e.getUint8(1)) for (var a = e.byteLength, n = 2; n + 1 < a;) { if (255 === e.getUint8(n) && 225 === e.getUint8(n + 1)) { d = n; break } n += 1 } if (d) { var o = d + 4, r = d + 10; if ("Exif" === function t(i, e, a) { var n = ""; a += e; for (var o = e; o < a; o += 1)n += tk(i.getUint8(o)); return n }(e, o, 4)) { var s = e.getUint16(r); if (((l = 18761 === s) || 19789 === s) && 42 === e.getUint16(r + 2, l)) { var h = e.getUint32(r + 4, l); h >= 8 && (p = r + h) } } } if (p) { var c, l, d, p, g, u, m = e.getUint16(p, l); for (u = 0; u < m; u += 1)if (g = p + 12 * u + 2, 274 === e.getUint16(g, l)) { g += 8, c = e.getUint16(g, l), e.setUint16(g, 1, l); break } } } catch (f) { c = 1 } return c }(i), o = 0, r = 1, s = 1; if (n > 1) { this.url = function t(i, e) { for (var a = [], n = new Uint8Array(i); n.length > 0;)a.push(tk.apply(null, tt(n.subarray(0, 8192)))), n = n.subarray(8192); return "data:".concat(e, ";base64,").concat(btoa(a.join(""))) }(i, S); var h = function t(i) { var e = 0, a = 1, n = 1; switch (i) { case 2: a = -1; break; case 3: e = -180; break; case 4: n = -1; break; case 5: e = 90, n = -1; break; case 6: e = 90; break; case 7: e = 90, a = -1; break; case 8: e = -90 }return { rotate: e, scaleX: a, scaleY: n } }(n); o = h.rotate, r = h.scaleX, s = h.scaleY } e.rotatable && (a.rotate = o), e.scalable && (a.scaleX = r, a.scaleY = s), this.clone() } }, { key: "clone", value: function t() { var i = this.element, e = this.url, a = i.crossOrigin, n = e; this.options.checkCrossOrigin && tb(e) && (a || (a = "anonymous"), n = t_(e)), this.crossOrigin = a, this.crossOriginUrl = n; var o = document.createElement("img"); a && (o.crossOrigin = a), o.src = n || e, o.alt = i.alt || "The image to crop", this.image = o, o.onload = this.start.bind(this), o.onerror = this.stop.bind(this), ts(o, $), i.parentNode.insertBefore(o, i.nextSibling) } }, { key: "start", value: function t() { var i = this, e = this.image; e.onload = null, e.onerror = null, this.sizing = !0; var a = h.navigator && /(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(h.navigator.userAgent), n = function t(e, a) { te(i.imageData, { naturalWidth: e, naturalHeight: a, aspectRatio: e / a }), i.initialImageData = te({}, i.imageData), i.sizing = !1, i.sized = !0, i.build() }; if (e.naturalWidth && !a) { n(e.naturalWidth, e.naturalHeight); return } var o = document.createElement("img"), r = document.body || document.documentElement; this.sizingImage = o, o.onload = function () { n(o.width, o.height), a || r.removeChild(o) }, o.src = e.src, a || (o.style.cssText = "left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;", r.appendChild(o)) } }, { key: "stop", value: function t() { var i = this.image; i.onload = null, i.onerror = null, i.parentNode.removeChild(i), this.image = null } }, { key: "build", value: function t() { if (this.sized && !this.ready) { var i = this.element, e = this.options, a = this.image, n = i.parentNode, o = document.createElement("div"); o.innerHTML = '<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>'; var r = o.querySelector(".".concat(d, "-container")), s = r.querySelector(".".concat(d, "-canvas")), h = r.querySelector(".".concat(d, "-drag-box")), c = r.querySelector(".".concat(d, "-crop-box")), l = c.querySelector(".".concat(d, "-face")); this.container = n, this.cropper = r, this.canvas = s, this.dragBox = h, this.cropBox = c, this.viewBox = r.querySelector(".".concat(d, "-view-box")), this.face = l, s.appendChild(a), ts(i, v), n.insertBefore(r, i.nextSibling), this.isImg || th(a, $), this.initPreview(), this.bind(), e.initialAspectRatio = Math.max(0, e.initialAspectRatio) || NaN, e.aspectRatio = Math.max(0, e.aspectRatio) || NaN, e.viewMode = Math.max(0, Math.min(3, Math.round(e.viewMode))) || 0, ts(c, v), e.guides || ts(c.getElementsByClassName("".concat(d, "-dashed")), v), e.center || ts(c.getElementsByClassName("".concat(d, "-center")), v), e.background && ts(r, "".concat(d, "-bg")), e.highlight || ts(l, w), e.cropBoxMovable && (ts(l, y), tg(l, b, "all")), e.cropBoxResizable || (ts(c.getElementsByClassName("".concat(d, "-line")), v), ts(c.getElementsByClassName("".concat(d, "-point")), v)), this.render(), this.ready = !0, this.setDragMode(e.dragMode), e.autoCrop && this.crop(), this.setData(e.data), J(e.ready) && tv(i, X, e.ready, { once: !0 }), t$(i, X) } } }, { key: "unbuild", value: function t() { this.ready && (this.ready = !1, this.unbind(), this.resetPreview(), this.cropper.parentNode.removeChild(this.cropper), th(this.element, v)) } }, { key: "uncreate", value: function t() { this.ready ? (this.unbuild(), this.ready = !1, this.cropped = !1) : this.sizing ? (this.sizingImage.onload = null, this.sizing = !1, this.sized = !1) : this.reloading ? (this.xhr.onabort = null, this.xhr.abort()) : this.image && this.stop() } }], e = [{ key: "noConflict", value: function t() { return window.Cropper = tW, n } }, { key: "setDefaults", value: function t(i) { te(U, G(i) && i) } }], i && a(t.prototype, i), e && a(t, e), n }(); return te(tE.prototype, { render: function t() { this.initContainer(), this.initCanvas(), this.initCropBox(), this.renderCanvas(), this.cropped && this.renderCropBox() }, initContainer: function t() { var i = this.element, e = this.options, a = this.container, n = this.cropper, o = Number(e.minContainerWidth), r = Number(e.minContainerHeight); ts(n, v), th(i, v); var s = { width: Math.max(a.offsetWidth, o >= 0 ? o : 200), height: Math.max(a.offsetHeight, r >= 0 ? r : 100) }; this.containerData = s, tr(n, { width: s.width, height: s.height }), ts(i, v), th(n, v) }, initCanvas: function t() { var i = this.containerData, e = this.imageData, a = this.options.viewMode, n = Math.abs(e.rotate) % 180 == 90, o = n ? e.naturalHeight : e.naturalWidth, r = n ? e.naturalWidth : e.naturalHeight, s = o / r, h = i.width, c = i.height; i.height * s > i.width ? 3 === a ? h = i.height * s : c = i.width / s : 3 === a ? c = i.width / s : h = i.height * s; var l = { aspectRatio: s, naturalWidth: o, naturalHeight: r, width: h, height: c }; this.canvasData = l, this.limited = 1 === a || 2 === a, this.limitCanvas(!0, !0), l.width = Math.min(Math.max(l.width, l.minWidth), l.maxWidth), l.height = Math.min(Math.max(l.height, l.minHeight), l.maxHeight), l.left = (i.width - l.width) / 2, l.top = (i.height - l.height) / 2, l.oldLeft = l.left, l.oldTop = l.top, this.initialCanvasData = te({}, l) }, limitCanvas: function t(i, e) { var a = this.options, n = this.containerData, o = this.canvasData, r = this.cropBoxData, s = a.viewMode, h = o.aspectRatio, c = this.cropped && r; if (i) { var l = Number(a.minCanvasWidth) || 0, d = Number(a.minCanvasHeight) || 0; s > 1 ? (l = Math.max(l, n.width), d = Math.max(d, n.height), 3 === s && (d * h > l ? l = d * h : d = l / h)) : s > 0 && (l ? l = Math.max(l, c ? r.width : 0) : d ? d = Math.max(d, c ? r.height : 0) : c && (l = r.width, (d = r.height) * h > l ? l = d * h : d = l / h)); var p = tB({ aspectRatio: h, width: l, height: d }); l = p.width, d = p.height, o.minWidth = l, o.minHeight = d, o.maxWidth = 1 / 0, o.maxHeight = 1 / 0 } if (e) { if (s > (c ? 0 : 1)) { var g = n.width - o.width, u = n.height - o.height; o.minLeft = Math.min(0, g), o.minTop = Math.min(0, u), o.maxLeft = Math.max(0, g), o.maxTop = Math.max(0, u), c && this.limited && (o.minLeft = Math.min(r.left, r.left + (r.width - o.width)), o.minTop = Math.min(r.top, r.top + (r.height - o.height)), o.maxLeft = r.left, o.maxTop = r.top, 2 === s && (o.width >= n.width && (o.minLeft = Math.min(0, g), o.maxLeft = Math.max(0, g)), o.height >= n.height && (o.minTop = Math.min(0, u), o.maxTop = Math.max(0, u)))) } else o.minLeft = -o.width, o.minTop = -o.height, o.maxLeft = n.width, o.maxTop = n.height } }, renderCanvas: function t(i, e) { var a = this.canvasData, n = this.imageData; if (e) { var o = function t(i) { var e = i.width, a = i.height, n = i.degree; if (90 == (n = Math.abs(n) % 180)) return { width: a, height: e }; var o = n % 90 * Math.PI / 180, r = Math.sin(o), s = Math.cos(o), h = e * s + a * r, c = e * r + a * s; return n > 90 ? { width: c, height: h } : { width: h, height: c } }({ width: n.naturalWidth * Math.abs(n.scaleX || 1), height: n.naturalHeight * Math.abs(n.scaleY || 1), degree: n.rotate || 0 }), r = o.width, s = o.height, h = a.width * (r / a.naturalWidth), c = a.height * (s / a.naturalHeight); a.left -= (h - a.width) / 2, a.top -= (c - a.height) / 2, a.width = h, a.height = c, a.aspectRatio = r / s, a.naturalWidth = r, a.naturalHeight = s, this.limitCanvas(!0, !1) } (a.width > a.maxWidth || a.width < a.minWidth) && (a.left = a.oldLeft), (a.height > a.maxHeight || a.height < a.minHeight) && (a.top = a.oldTop), a.width = Math.min(Math.max(a.width, a.minWidth), a.maxWidth), a.height = Math.min(Math.max(a.height, a.minHeight), a.maxHeight), this.limitCanvas(!1, !0), a.left = Math.min(Math.max(a.left, a.minLeft), a.maxLeft), a.top = Math.min(Math.max(a.top, a.minTop), a.maxTop), a.oldLeft = a.left, a.oldTop = a.top, tr(this.canvas, te({ width: a.width, height: a.height }, tC({ translateX: a.left, translateY: a.top }))), this.renderImage(i), this.cropped && this.limited && this.limitCropBox(!0, !0) }, renderImage: function t(i) { var e = this.canvasData, a = this.imageData, n = a.naturalWidth * (e.width / e.naturalWidth), o = a.naturalHeight * (e.height / e.naturalHeight); te(a, { width: n, height: o, left: (e.width - n) / 2, top: (e.height - o) / 2 }), tr(this.image, te({ width: a.width, height: a.height }, tC(te({ translateX: a.left, translateY: a.top }, a)))), i && this.output() }, initCropBox: function t() { var i = this.options, e = this.canvasData, a = i.aspectRatio || i.initialAspectRatio, n = Number(i.autoCropArea) || .8, o = { width: e.width, height: e.height }; a && (e.height * a > e.width ? o.height = o.width / a : o.width = o.height * a), this.cropBoxData = o, this.limitCropBox(!0, !0), o.width = Math.min(Math.max(o.width, o.minWidth), o.maxWidth), o.height = Math.min(Math.max(o.height, o.minHeight), o.maxHeight), o.width = Math.max(o.minWidth, o.width * n), o.height = Math.max(o.minHeight, o.height * n), o.left = e.left + (e.width - o.width) / 2, o.top = e.top + (e.height - o.height) / 2, o.oldLeft = o.left, o.oldTop = o.top, this.initialCropBoxData = te({}, o) }, limitCropBox: function t(i, e) { var a = this.options, n = this.containerData, o = this.canvasData, r = this.cropBoxData, s = this.limited, h = a.aspectRatio; if (i) { var c = Number(a.minCropBoxWidth) || 0, l = Number(a.minCropBoxHeight) || 0, d = s ? Math.min(n.width, o.width, o.width + o.left, n.width - o.left) : n.width, p = s ? Math.min(n.height, o.height, o.height + o.top, n.height - o.top) : n.height; c = Math.min(c, n.width), l = Math.min(l, n.height), h && (c && l ? l * h > c ? l = c / h : c = l * h : c ? l = c / h : l && (c = l * h), p * h > d ? p = d / h : d = p * h), r.minWidth = Math.min(c, d), r.minHeight = Math.min(l, p), r.maxWidth = d, r.maxHeight = p } e && (s ? (r.minLeft = Math.max(0, o.left), r.minTop = Math.max(0, o.top), r.maxLeft = Math.min(n.width, o.left + o.width) - r.width, r.maxTop = Math.min(n.height, o.top + o.height) - r.height) : (r.minLeft = 0, r.minTop = 0, r.maxLeft = n.width - r.width, r.maxTop = n.height - r.height)) }, renderCropBox: function t() { var i = this.options, e = this.containerData, a = this.cropBoxData; (a.width > a.maxWidth || a.width < a.minWidth) && (a.left = a.oldLeft), (a.height > a.maxHeight || a.height < a.minHeight) && (a.top = a.oldTop), a.width = Math.min(Math.max(a.width, a.minWidth), a.maxWidth), a.height = Math.min(Math.max(a.height, a.minHeight), a.maxHeight), this.limitCropBox(!1, !0), a.left = Math.min(Math.max(a.left, a.minLeft), a.maxLeft), a.top = Math.min(Math.max(a.top, a.minTop), a.maxTop), a.oldLeft = a.left, a.oldTop = a.top, i.movable && i.cropBoxMovable && tg(this.face, b, a.width >= e.width && a.height >= e.height ? g : "all"), tr(this.cropBox, te({ width: a.width, height: a.height }, tC({ translateX: a.left, translateY: a.top }))), this.cropped && this.limited && this.limitCanvas(!0, !0), this.disabled || this.output() }, output: function t() { this.preview(), t$(this.element, k, this.getData()) } }, { initPreview: function t() { var i = this.element, e = this.crossOrigin, a = this.options.preview, n = e ? this.crossOriginUrl : this.url, o = i.alt || "The image to preview", r = document.createElement("img"); if (e && (r.crossOrigin = e), r.src = n, r.alt = o, this.viewBox.appendChild(r), this.viewBoxImage = r, a) { var s = a; "string" == typeof a ? s = i.ownerDocument.querySelectorAll(a) : a.querySelector && (s = [a]), this.previews = s, ti(s, function (t) { var i = document.createElement("img"); tg(t, _, { width: t.offsetWidth, height: t.offsetHeight, html: t.innerHTML }), e && (i.crossOrigin = e), i.src = n, i.alt = o, i.style.cssText = 'display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"', t.innerHTML = "", t.appendChild(i) }) } }, resetPreview: function t() { ti(this.previews, function (t) { var i = tp(t, _); tr(t, { width: i.width, height: i.height }), t.innerHTML = i.html, function t(i, e) { if (K(i[e])) try { delete i[e] } catch (a) { i[e] = void 0 } else if (i.dataset) try { delete i.dataset[e] } catch (n) { i.dataset[e] = void 0 } else i.removeAttribute("data-".concat(td(e))) }(t, _) }) }, preview: function t() { var i = this.imageData, e = this.canvasData, a = this.cropBoxData, n = a.width, o = a.height, r = i.width, s = i.height, h = a.left - e.left - i.left, c = a.top - e.top - i.top; this.cropped && !this.disabled && (tr(this.viewBoxImage, te({ width: r, height: s }, tC(te({ translateX: -h, translateY: -c }, i)))), ti(this.previews, function (t) { var e = tp(t, _), a = e.width, l = e.height, d = a, p = l, g = 1; n && (p = o * (g = a / n)), o && p > l && (d = n * (g = l / o), p = l), tr(t, { width: d, height: p }), tr(t.getElementsByTagName("img")[0], te({ width: r * g, height: s * g }, tC(te({ translateX: -h * g, translateY: -c * g }, i)))) })) } }, { bind: function t() { var i = this.element, e = this.options, a = this.cropper; J(e.cropstart) && tv(i, E, e.cropstart), J(e.cropmove) && tv(i, W, e.cropmove), J(e.cropend) && tv(i, T, e.cropend), J(e.crop) && tv(i, k, e.crop), J(e.zoom) && tv(i, M, e.zoom), tv(a, L, this.onCropStart = this.cropStart.bind(this)), e.zoomable && e.zoomOnWheel && tv(a, O, this.onWheel = this.wheel.bind(this), { passive: !1, capture: !0 }), e.toggleDragModeOnDblclick && tv(a, H, this.onDblclick = this.dblclick.bind(this)), tv(i.ownerDocument, z, this.onCropMove = this.cropMove.bind(this)), tv(i.ownerDocument, Y, this.onCropEnd = this.cropEnd.bind(this)), e.responsive && tv(window, R, this.onResize = this.resize.bind(this)) }, unbind: function t() { var i = this.element, e = this.options, a = this.cropper; J(e.cropstart) && tf(i, E, e.cropstart), J(e.cropmove) && tf(i, W, e.cropmove), J(e.cropend) && tf(i, T, e.cropend), J(e.crop) && tf(i, k, e.crop), J(e.zoom) && tf(i, M, e.zoom), tf(a, L, this.onCropStart), e.zoomable && e.zoomOnWheel && tf(a, O, this.onWheel, { passive: !1, capture: !0 }), e.toggleDragModeOnDblclick && tf(a, H, this.onDblclick), tf(i.ownerDocument, z, this.onCropMove), tf(i.ownerDocument, Y, this.onCropEnd), e.responsive && tf(window, R, this.onResize) } }, { resize: function t() { if (!this.disabled) { var i, e, a = this.options, n = this.container, o = this.containerData, r = n.offsetWidth / o.width, s = n.offsetHeight / o.height, h = Math.abs(r - 1) > Math.abs(s - 1) ? r : s; 1 !== h && (a.restore && (i = this.getCanvasData(), e = this.getCropBoxData()), this.render(), a.restore && (this.setCanvasData(ti(i, function (t, e) { i[e] = t * h })), this.setCropBoxData(ti(e, function (t, i) { e[i] = t * h })))) } }, dblclick: function t() { var i, e; !this.disabled && this.options.dragMode !== B && this.setDragMode((i = this.dragBox, e = m, i.classList ? i.classList.contains(e) : i.className.indexOf(e) > -1) ? D : C) }, wheel: function t(i) { var e = this, a = Number(this.options.wheelZoomRatio) || .1, n = 1; if (!this.disabled) i.preventDefault(), !this.wheeling && (this.wheeling = !0, setTimeout(function () { e.wheeling = !1 }, 50), i.deltaY ? n = i.deltaY > 0 ? 1 : -1 : i.wheelDelta ? n = -i.wheelDelta / 120 : i.detail && (n = i.detail > 0 ? 1 : -1), this.zoom(-n * a, i)) }, cropStart: function t(i) { var e, a = i.buttons, n = i.button; if (!(this.disabled || ("mousedown" === i.type || "pointerdown" === i.type && "mouse" === i.pointerType) && (j(a) && 1 !== a || j(n) && 0 !== n || i.ctrlKey))) { var o = this.options, r = this.pointers; i.changedTouches ? ti(i.changedTouches, function (t) { r[t.identifier] = tD(t) }) : r[i.pointerId || 0] = tD(i), e = Object.keys(r).length > 1 && o.zoomable && o.zoomOnTouch ? u : tp(i.target, b), I.test(e) && !1 !== t$(this.element, E, { originalEvent: i, action: e }) && (i.preventDefault(), this.action = e, this.cropping = !1, e === p && (this.cropping = !0, ts(this.dragBox, x))) } }, cropMove: function t(i) { var e = this.action; if (!this.disabled && e) { var a = this.pointers; i.preventDefault(), !1 !== t$(this.element, W, { originalEvent: i, action: e }) && (i.changedTouches ? ti(i.changedTouches, function (t) { te(a[t.identifier] || {}, tD(t, !0)) }) : te(a[i.pointerId || 0] || {}, tD(i, !0)), this.change(i)) } }, cropEnd: function t(i) { if (!this.disabled) { var e = this.action, a = this.pointers; i.changedTouches ? ti(i.changedTouches, function (t) { delete a[t.identifier] }) : delete a[i.pointerId || 0], e && (i.preventDefault(), Object.keys(a).length || (this.action = ""), this.cropping && (this.cropping = !1, tc(this.dragBox, x, this.cropped && this.options.modal)), t$(this.element, T, { originalEvent: i, action: e })) } } }, { change: function t(e) { var a, n, o, r, s = this.options, h = this.canvasData, c = this.containerData, l = this.cropBoxData, d = this.pointers, m = this.action, f = s.aspectRatio, $ = l.left, w = l.top, x = l.width, y = l.height, b = $ + x, _ = w + y, C = 0, D = 0, B = c.width, k = c.height, T = !0; !f && e.shiftKey && (f = x && y ? x / y : 1), this.limited && (C = l.minLeft, D = l.minTop, B = C + Math.min(c.width, h.width, h.left + h.width), k = D + Math.min(c.height, h.height, h.top + h.height)); var W = d[Object.keys(d)[0]], E = { x: W.endX - W.startX, y: W.endY - W.startY }, H = function t(i) { switch (i) { case "e": b + E.x > B && (E.x = B - b); break; case "w": $ + E.x < C && (E.x = C - $); break; case "n": w + E.y < D && (E.y = D - w); break; case "s": _ + E.y > k && (E.y = k - _) } }; switch (m) { case "all": $ += E.x, w += E.y; break; case "e": if (E.x >= 0 && (b >= B || f && (w <= D || _ >= k))) { T = !1; break } H("e"), (x += E.x) < 0 && (m = "w", $ -= x = -x), f && (y = x / f, w += (l.height - y) / 2); break; case "n": if (E.y <= 0 && (w <= D || f && ($ <= C || b >= B))) { T = !1; break } H("n"), y -= E.y, w += E.y, y < 0 && (m = "s", w -= y = -y), f && (x = y * f, $ += (l.width - x) / 2); break; case "w": if (E.x <= 0 && ($ <= C || f && (w <= D || _ >= k))) { T = !1; break } H("w"), x -= E.x, $ += E.x, x < 0 && (m = "e", $ -= x = -x), f && (y = x / f, w += (l.height - y) / 2); break; case "s": if (E.y >= 0 && (_ >= k || f && ($ <= C || b >= B))) { T = !1; break } H("s"), (y += E.y) < 0 && (m = "n", w -= y = -y), f && (x = y * f, $ += (l.width - x) / 2); break; case "ne": if (f) { if (E.y <= 0 && (w <= D || b >= B)) { T = !1; break } H("n"), y -= E.y, w += E.y, x = y * f } else H("n"), H("e"), E.x >= 0 ? b < B ? x += E.x : E.y <= 0 && w <= D && (T = !1) : x += E.x, E.y <= 0 ? w > D && (y -= E.y, w += E.y) : (y -= E.y, w += E.y); x < 0 && y < 0 ? (m = "sw", x = -x, w -= y = -y, $ -= x) : x < 0 ? (m = "nw", $ -= x = -x) : y < 0 && (m = "se", w -= y = -y); break; case "nw": if (f) { if (E.y <= 0 && (w <= D || $ <= C)) { T = !1; break } H("n"), y -= E.y, w += E.y, x = y * f, $ += l.width - x } else H("n"), H("w"), E.x <= 0 ? $ > C ? (x -= E.x, $ += E.x) : E.y <= 0 && w <= D && (T = !1) : (x -= E.x, $ += E.x), E.y <= 0 ? w > D && (y -= E.y, w += E.y) : (y -= E.y, w += E.y); x < 0 && y < 0 ? (m = "se", x = -x, w -= y = -y, $ -= x) : x < 0 ? (m = "ne", $ -= x = -x) : y < 0 && (m = "sw", w -= y = -y); break; case "sw": if (f) { if (E.x <= 0 && ($ <= C || _ >= k)) { T = !1; break } H("w"), x -= E.x, $ += E.x, y = x / f } else H("s"), H("w"), E.x <= 0 ? $ > C ? (x -= E.x, $ += E.x) : E.y >= 0 && _ >= k && (T = !1) : (x -= E.x, $ += E.x), E.y >= 0 ? _ < k && (y += E.y) : y += E.y; x < 0 && y < 0 ? (m = "ne", x = -x, w -= y = -y, $ -= x) : x < 0 ? (m = "se", $ -= x = -x) : y < 0 && (m = "nw", w -= y = -y); break; case "se": if (f) { if (E.x >= 0 && (b >= B || _ >= k)) { T = !1; break } H("e"), x += E.x, y = x / f } else H("s"), H("e"), E.x >= 0 ? b < B ? x += E.x : E.y >= 0 && _ >= k && (T = !1) : x += E.x, E.y >= 0 ? _ < k && (y += E.y) : y += E.y; x < 0 && y < 0 ? (m = "nw", x = -x, w -= y = -y, $ -= x) : x < 0 ? (m = "sw", $ -= x = -x) : y < 0 && (m = "ne", w -= y = -y); break; case g: this.move(E.x, E.y), T = !1; break; case u: this.zoom((n = i({}, a = d), o = 0, ti(a, function (t, i) { delete n[i], ti(n, function (i) { var e = Math.abs(t.startX - i.startX), a = Math.abs(t.startY - i.startY), n = Math.abs(t.endX - i.endX), r = Math.abs(t.endY - i.endY), s = Math.sqrt(e * e + a * a), h = (Math.sqrt(n * n + r * r) - s) / s; Math.abs(h) > Math.abs(o) && (o = h) }) }), o), e), T = !1; break; case p: if (!E.x || !E.y) { T = !1; break } r = tw(this.cropper), $ = W.startX - r.left, w = W.startY - r.top, x = l.minWidth, y = l.minHeight, E.x > 0 ? m = E.y > 0 ? "se" : "ne" : E.x < 0 && ($ -= x, m = E.y > 0 ? "sw" : "nw"), E.y < 0 && (w -= y), !this.cropped && (th(this.cropBox, v), this.cropped = !0, this.limited && this.limitCropBox(!0, !0)) }T && (l.width = x, l.height = y, l.left = $, l.top = w, this.action = m, this.renderCropBox()), ti(d, function (t) { t.startX = t.endX, t.startY = t.endY }) } }, { crop: function t() { return !this.ready || this.cropped || this.disabled || (this.cropped = !0, this.limitCropBox(!0, !0), this.options.modal && ts(this.dragBox, x), th(this.cropBox, v), this.setCropBoxData(this.initialCropBoxData)), this }, reset: function t() { return this.ready && !this.disabled && (this.imageData = te({}, this.initialImageData), this.canvasData = te({}, this.initialCanvasData), this.cropBoxData = te({}, this.initialCropBoxData), this.renderCanvas(), this.cropped && this.renderCropBox()), this }, clear: function t() { return this.cropped && !this.disabled && (te(this.cropBoxData, { left: 0, top: 0, width: 0, height: 0 }), this.cropped = !1, this.renderCropBox(), this.limitCanvas(!0, !0), this.renderCanvas(), th(this.dragBox, x), ts(this.cropBox, v)), this }, replace: function t(i) { var e = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]; return !this.disabled && i && (this.isImg && (this.element.src = i), e ? (this.url = i, this.image.src = i, this.ready && (this.viewBoxImage.src = i, ti(this.previews, function (t) { t.getElementsByTagName("img")[0].src = i }))) : (this.isImg && (this.replaced = !0), this.options.data = null, this.uncreate(), this.load(i))), this }, enable: function t() { return this.ready && this.disabled && (this.disabled = !1, th(this.cropper, f)), this }, disable: function t() { return this.ready && !this.disabled && (this.disabled = !0, ts(this.cropper, f)), this }, destroy: function t() { var i = this.element; return i[d] && (i[d] = void 0, this.isImg && this.replaced && (i.src = this.originalUrl), this.uncreate()), this }, move: function t(i) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : i, a = this.canvasData, n = a.left, o = a.top; return this.moveTo(Q(i) ? i : n + Number(i), Q(e) ? e : o + Number(e)) }, moveTo: function t(i) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : i, a = this.canvasData, n = !1; return i = Number(i), e = Number(e), this.ready && !this.disabled && this.options.movable && (j(i) && (a.left = i, n = !0), j(e) && (a.top = e, n = !0), n && this.renderCanvas(!0)), this }, zoom: function t(i, e) { var a = this.canvasData; return i = (i = Number(i)) < 0 ? 1 / (1 - i) : 1 + i, this.zoomTo(a.width * i / a.naturalWidth, null, e) }, zoomTo: function t(i, e, a) { var n = this.options, o = this.canvasData, r = o.width, s = o.height, h = o.naturalWidth, c = o.naturalHeight; if ((i = Number(i)) >= 0 && this.ready && !this.disabled && n.zoomable) { var l = h * i, d = c * i; if (!1 === t$(this.element, M, { ratio: i, oldRatio: r / h, originalEvent: a })) return this; if (a) { var p, g, u, m, f = this.pointers, v = tw(this.cropper), $ = f && Object.keys(f).length ? (p = f, g = 0, u = 0, m = 0, ti(p, function (t) { var i = t.startX, e = t.startY; g += i, u += e, m += 1 }), { pageX: g /= m, pageY: u /= m }) : { pageX: a.pageX, pageY: a.pageY }; o.left -= (l - r) * (($.pageX - v.left - o.left) / r), o.top -= (d - s) * (($.pageY - v.top - o.top) / s) } else G(e) && j(e.x) && j(e.y) ? (o.left -= (l - r) * ((e.x - o.left) / r), o.top -= (d - s) * ((e.y - o.top) / s)) : (o.left -= (l - r) / 2, o.top -= (d - s) / 2); o.width = l, o.height = d, this.renderCanvas(!0) } return this }, rotate: function t(i) { return this.rotateTo((this.imageData.rotate || 0) + Number(i)) }, rotateTo: function t(i) { return j(i = Number(i)) && this.ready && !this.disabled && this.options.rotatable && (this.imageData.rotate = i % 360, this.renderCanvas(!0, !0)), this }, scaleX: function t(i) { var e = this.imageData.scaleY; return this.scale(i, j(e) ? e : 1) }, scaleY: function t(i) { var e = this.imageData.scaleX; return this.scale(j(e) ? e : 1, i) }, scale: function t(i) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : i, a = this.imageData, n = !1; return i = Number(i), e = Number(e), this.ready && !this.disabled && this.options.scalable && (j(i) && (a.scaleX = i, n = !0), j(e) && (a.scaleY = e, n = !0), n && this.renderCanvas(!0, !0)), this }, getData: function t() { var i, e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0], a = this.options, n = this.imageData, o = this.canvasData, r = this.cropBoxData; if (this.ready && this.cropped) { i = { x: r.left - o.left, y: r.top - o.top, width: r.width, height: r.height }; var s = n.width / n.naturalWidth; if (ti(i, function (t, e) { i[e] = t / s }), e) { var h = Math.round(i.y + i.height), c = Math.round(i.x + i.width); i.x = Math.round(i.x), i.y = Math.round(i.y), i.width = c - i.x, i.height = h - i.y } } else i = { x: 0, y: 0, width: 0, height: 0 }; return a.rotatable && (i.rotate = n.rotate || 0), a.scalable && (i.scaleX = n.scaleX || 1, i.scaleY = n.scaleY || 1), i }, setData: function t(i) { var e = this.options, a = this.imageData, n = this.canvasData, o = {}; if (this.ready && !this.disabled && G(i)) { var r = !1; e.rotatable && j(i.rotate) && i.rotate !== a.rotate && (a.rotate = i.rotate, r = !0), e.scalable && (j(i.scaleX) && i.scaleX !== a.scaleX && (a.scaleX = i.scaleX, r = !0), j(i.scaleY) && i.scaleY !== a.scaleY && (a.scaleY = i.scaleY, r = !0)), r && this.renderCanvas(!0, !0); var s = a.width / a.naturalWidth; j(i.x) && (o.left = i.x * s + n.left), j(i.y) && (o.top = i.y * s + n.top), j(i.width) && (o.width = i.width * s), j(i.height) && (o.height = i.height * s), this.setCropBoxData(o) } return this }, getContainerData: function t() { return this.ready ? te({}, this.containerData) : {} }, getImageData: function t() { return this.sized ? te({}, this.imageData) : {} }, getCanvasData: function t() { var i = this.canvasData, e = {}; return this.ready && ti(["left", "top", "width", "height", "naturalWidth", "naturalHeight"], function (t) { e[t] = i[t] }), e }, setCanvasData: function t(i) { var e = this.canvasData, a = e.aspectRatio; return this.ready && !this.disabled && G(i) && (j(i.left) && (e.left = i.left), j(i.top) && (e.top = i.top), j(i.width) ? (e.width = i.width, e.height = i.width / a) : j(i.height) && (e.height = i.height, e.width = i.height * a), this.renderCanvas(!0)), this }, getCropBoxData: function t() { var i, e = this.cropBoxData; return this.ready && this.cropped && (i = { left: e.left, top: e.top, width: e.width, height: e.height }), i || {} }, setCropBoxData: function t(i) { var e, a, n = this.cropBoxData, o = this.options.aspectRatio; return this.ready && this.cropped && !this.disabled && G(i) && (j(i.left) && (n.left = i.left), j(i.top) && (n.top = i.top), j(i.width) && i.width !== n.width && (e = !0, n.width = i.width), j(i.height) && i.height !== n.height && (a = !0, n.height = i.height), o && (e ? n.height = n.width / o : a && (n.width = n.height * o)), this.renderCropBox()), this }, getCroppedCanvas: function t() { var i, e, a, n, r, s, h = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; if (!this.ready || !window.HTMLCanvasElement) return null; var c, l, d, p, g, u, m, f, v, $, w, x, y, b, _, C, D, B, k, T, W, E, H, L, z, Y, X, R, O, M, S, I, P, A, N = this.canvasData, U = (c = this.image, l = this.imageData, d = N, p = h, g = l.aspectRatio, u = l.naturalWidth, m = l.naturalHeight, f = l.rotate, v = l.scaleX, $ = l.scaleY, w = d.aspectRatio, x = d.naturalWidth, y = d.naturalHeight, b = p.fillColor, _ = p.imageSmoothingEnabled, C = p.imageSmoothingQuality, B = void 0 === (D = p.maxWidth) ? 1 / 0 : D, T = void 0 === (k = p.maxHeight) ? 1 / 0 : k, E = void 0 === (W = p.minWidth) ? 0 : W, L = void 0 === (H = p.minHeight) ? 0 : H, Y = (z = document.createElement("canvas")).getContext("2d"), X = tB({ aspectRatio: w, width: B, height: T }), R = tB({ aspectRatio: w, width: E, height: L }, "cover"), O = Math.min(X.width, Math.max(R.width, x)), M = Math.min(X.height, Math.max(R.height, y)), S = tB({ aspectRatio: g, width: B, height: T }), I = tB({ aspectRatio: g, width: E, height: L }, "cover"), P = Math.min(S.width, Math.max(I.width, u)), A = Math.min(S.height, Math.max(I.height, m)), z.width = tn(O), z.height = tn(M), Y.fillStyle = void 0 === b ? "transparent" : b, Y.fillRect(0, 0, O, M), Y.save(), Y.translate(O / 2, M / 2), Y.rotate((void 0 === f ? 0 : f) * Math.PI / 180), Y.scale(void 0 === v ? 1 : v, void 0 === $ ? 1 : $), Y.imageSmoothingEnabled = void 0 === _ || _, Y.imageSmoothingQuality = void 0 === C ? "low" : C, Y.drawImage.apply(Y, [c].concat(o([-P / 2, -A / 2, P, A].map(function (t) { return Math.floor(tn(t)) })))), Y.restore(), z); if (!this.cropped) return U; var q = this.getData(), j = q.x, F = q.y, Q = q.width, K = q.height, Z = U.width / Math.floor(N.naturalWidth); 1 !== Z && (j *= Z, F *= Z, Q *= Z, K *= Z); var G = Q / K, J = tB({ aspectRatio: G, width: h.maxWidth || 1 / 0, height: h.maxHeight || 1 / 0 }), V = tB({ aspectRatio: G, width: h.minWidth || 0, height: h.minHeight || 0 }, "cover"), tt = tB({ aspectRatio: G, width: h.width || (1 !== Z ? U.width : Q), height: h.height || (1 !== Z ? U.height : K) }), ti = tt.width, te = tt.height; ti = Math.min(J.width, Math.max(V.width, ti)), te = Math.min(J.height, Math.max(V.height, te)); var ta = document.createElement("canvas"), to = ta.getContext("2d"); ta.width = tn(ti), ta.height = tn(te), to.fillStyle = h.fillColor || "transparent", to.fillRect(0, 0, ti, te); var tr = h.imageSmoothingEnabled, ts = h.imageSmoothingQuality; to.imageSmoothingEnabled = void 0 === tr || tr, ts && (to.imageSmoothingQuality = ts); var th = U.width, tc = U.height, tl = j, td = F; tl <= -Q || tl > th ? (tl = 0, i = 0, a = 0, r = 0) : tl <= 0 ? (a = -tl, r = i = Math.min(th, Q + (tl = 0))) : tl <= th && (a = 0, r = i = Math.min(Q, th - tl)), i <= 0 || td <= -K || td > tc ? (td = 0, e = 0, n = 0, s = 0) : td <= 0 ? (n = -td, s = e = Math.min(tc, K + (td = 0))) : td <= tc && (n = 0, s = e = Math.min(K, tc - td)); var tp = [tl, td, i, e]; if (r > 0 && s > 0) { var tg = ti / Q; tp.push(a * tg, n * tg, r * tg, s * tg) } return to.drawImage.apply(to, [U].concat(o(tp.map(function (t) { return Math.floor(tn(t)) })))), ta }, setAspectRatio: function t(i) { var e = this.options; return !this.disabled && !Q(i) && (e.aspectRatio = Math.max(0, i) || NaN, this.ready && (this.initCropBox(), this.cropped && this.renderCropBox())), this }, setDragMode: function t(i) { var e = this.options, a = this.dragBox, n = this.face; if (this.ready && !this.disabled) { var o = i === C, r = e.movable && i === D; i = o || r ? i : B, e.dragMode = i, tg(a, b, i), tc(a, m, o), tc(a, y, r), e.cropBoxMovable || (tg(n, b, i), tc(n, m, o), tc(n, y, r)) } return this } }), tE });